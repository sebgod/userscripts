<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="/static/css/index.css" />
    <title>SQL02 Test</title>
</head>
<body>
<!--pas
var db := new DataBase('OleDB MSSQL2008', ['SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;Initial Catalog=Sorpetaler;Data Source=SQL02;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=MINE;Use Encryption for Data=False;Tag with column collation when possible=False']);

const SqlQuery = #"SELECT [ID_NR]
      ,[Kundenname]
      ,[Bauvorhaben]
  FROM [Sorpetaler].[dbo].[AUFTRAEGE]";                   
    
var start := Now;
var rowCount := 0;
?-->
<pre><!--pas=SqlQuery?--></pre>
    <table>
        <thead>
            <caption>Aufträge</caption>
            <tr>
                <th>ID</th>
                <th>Kundenname</th>
                <th>Bauvorhaben</th>
            </tr>
        </thead>
        <tbody>
        <!--pas
        var ds := db.Query(SqlQuery);

        // using different methods below for each for illustration purposes
              
        while not ds.Eof do begin
            
           ?-->
            <tr>
                <td><!--pas=ds.AsInteger('ID_Nr')?--></td>
                <td><!--pas=ds.AsString('Kundenname')?--></td>
                <td><!--pas=ds.AsString('Bauvorhaben')?--></td>                
            </tr>
           <!--pas
           Inc(rowCount);
           ds.Next;
        end;
        ?-->
        </tbody>
        <tfoot>
            <tr>
                <td colspan="3">
                    <ul>
                        <li>SQL Native version: <!--pas=db.VersionInfoText?--></li>
                        <li>Number of rows: <!--pas=rowCount?--></li>
                        <li>Time: <!--pas=FormatDateTime('hh"h"mm:ss,zzz', Now - start) ?--></li>
                    </ul>
                </td>
            </tr>
        </tfoot>
    </table>
<p></p>
</body>
</html>